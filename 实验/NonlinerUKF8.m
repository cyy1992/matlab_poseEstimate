function [ x,P ] = NonlinerUKF8(z,x,P,focalIndex,t,RelatObjCoor,euler2,T,flag)
%UNTITLED4 此处显示有关此函数的摘要
%   此处显示详细说明
persistent xm1 xm2 xd1 xd2;
m = size(z,2);
kx1 = focalIndex(1,1);
ky1 = focalIndex(2,1);
u01 = focalIndex(3,1);
v01 = focalIndex(4,1);
kx2 = focalIndex(1,2);
ky2 = focalIndex(2,2);
u02 = focalIndex(3,2);
v02 = focalIndex(4,2);

f=@(x)[x(1)+t*x(2);x(2);x(3)+t*x(4);x(4);x(5)+t*x(6);x(6);x(7)+t*x(8);x(8);x(9)+t*x(10);x(10);x(11)+t*x(12);x(12);];
% h1=@(x)[kx1*(x(1)+cos(x(7))*cos(x(9))*RelatObjCoor(1,1)+(cos(x(7))*sin(x(9))*sin(x(11))-sin(x(7))*cos(x(11)))*RelatObjCoor(1,2)+(cos(x(7))*sin(x(9))*cos(x(11))+sin(x(7))*sin(x(11)))*RelatObjCoor(1,3))/(x(5)-sin(x(9))*RelatObjCoor(1,1)+cos(x(9))*sin(x(11))*RelatObjCoor(1,2)+cos(x(9))*cos(x(11))*RelatObjCoor(1,3))+u01;
%        ky1*(x(3)+sin(x(7))*cos(x(9))*RelatObjCoor(1,1)+(sin(x(7))*sin(x(9))*sin(x(11))+cos(x(7))*cos(x(11)))*RelatObjCoor(1,2)+(sin(x(7))*sin(x(9))*cos(x(11))-cos(x(7))*sin(x(11)))*RelatObjCoor(1,3))/(x(5)-sin(x(9))*RelatObjCoor(1,1)+cos(x(9))*sin(x(11))*RelatObjCoor(1,2)+cos(x(9))*cos(x(11))*RelatObjCoor(1,3))+v01;
%        kx1*(x(1)+cos(x(7))*cos(x(9))*RelatObjCoor(2,1)+(cos(x(7))*sin(x(9))*sin(x(11))-sin(x(7))*cos(x(11)))*RelatObjCoor(2,2)+(cos(x(7))*sin(x(9))*cos(x(11))+sin(x(7))*sin(x(11)))*RelatObjCoor(2,3))/(x(5)-sin(x(9))*RelatObjCoor(2,1)+cos(x(9))*sin(x(11))*RelatObjCoor(2,2)+cos(x(9))*cos(x(11))*RelatObjCoor(2,3))+u01;
%        ky1*(x(3)+sin(x(7))*cos(x(9))*RelatObjCoor(2,1)+(sin(x(7))*sin(x(9))*sin(x(11))+cos(x(7))*cos(x(11)))*RelatObjCoor(2,2)+(sin(x(7))*sin(x(9))*cos(x(11))-cos(x(7))*sin(x(11)))*RelatObjCoor(2,3))/(x(5)-sin(x(9))*RelatObjCoor(2,1)+cos(x(9))*sin(x(11))*RelatObjCoor(2,2)+cos(x(9))*cos(x(11))*RelatObjCoor(2,3))+v01;
%        kx1*(x(1)+cos(x(7))*cos(x(9))*RelatObjCoor(3,1)+(cos(x(7))*sin(x(9))*sin(x(11))-sin(x(7))*cos(x(11)))*RelatObjCoor(3,2)+(cos(x(7))*sin(x(9))*cos(x(11))+sin(x(7))*sin(x(11)))*RelatObjCoor(3,3))/(x(5)-sin(x(9))*RelatObjCoor(3,1)+cos(x(9))*sin(x(11))*RelatObjCoor(3,2)+cos(x(9))*cos(x(11))*RelatObjCoor(3,3))+u01;
%        ky1*(x(3)+sin(x(7))*cos(x(9))*RelatObjCoor(3,1)+(sin(x(7))*sin(x(9))*sin(x(11))+cos(x(7))*cos(x(11)))*RelatObjCoor(3,2)+(sin(x(7))*sin(x(9))*cos(x(11))-cos(x(7))*sin(x(11)))*RelatObjCoor(3,3))/(x(5)-sin(x(9))*RelatObjCoor(3,1)+cos(x(9))*sin(x(11))*RelatObjCoor(3,2)+cos(x(9))*cos(x(11))*RelatObjCoor(3,3))+v01;
%        kx1*(x(1)+cos(x(7))*cos(x(9))*RelatObjCoor(4,1)+(cos(x(7))*sin(x(9))*sin(x(11))-sin(x(7))*cos(x(11)))*RelatObjCoor(4,2)+(cos(x(7))*sin(x(9))*cos(x(11))+sin(x(7))*sin(x(11)))*RelatObjCoor(4,3))/(x(5)-sin(x(9))*RelatObjCoor(4,1)+cos(x(9))*sin(x(11))*RelatObjCoor(4,2)+cos(x(9))*cos(x(11))*RelatObjCoor(4,3))+u01;
%        ky1*(x(3)+sin(x(7))*cos(x(9))*RelatObjCoor(4,1)+(sin(x(7))*sin(x(9))*sin(x(11))+cos(x(7))*cos(x(11)))*RelatObjCoor(4,2)+(sin(x(7))*sin(x(9))*cos(x(11))-cos(x(7))*sin(x(11)))*RelatObjCoor(4,3))/(x(5)-sin(x(9))*RelatObjCoor(4,1)+cos(x(9))*sin(x(11))*RelatObjCoor(4,2)+cos(x(9))*cos(x(11))*RelatObjCoor(4,3))+v01;
%        kx1*(x(1)+cos(x(7))*cos(x(9))*RelatObjCoor(5,1)+(cos(x(7))*sin(x(9))*sin(x(11))-sin(x(7))*cos(x(11)))*RelatObjCoor(5,2)+(cos(x(7))*sin(x(9))*cos(x(11))+sin(x(7))*sin(x(11)))*RelatObjCoor(5,3))/(x(5)-sin(x(9))*RelatObjCoor(5,1)+cos(x(9))*sin(x(11))*RelatObjCoor(1,2)+cos(x(9))*cos(x(11))*RelatObjCoor(5,3))+u01;
%        ky1*(x(3)+sin(x(7))*cos(x(9))*RelatObjCoor(5,1)+(sin(x(7))*sin(x(9))*sin(x(11))+cos(x(7))*cos(x(11)))*RelatObjCoor(5,2)+(sin(x(7))*sin(x(9))*cos(x(11))-cos(x(7))*sin(x(11)))*RelatObjCoor(5,3))/(x(5)-sin(x(9))*RelatObjCoor(5,1)+cos(x(9))*sin(x(11))*RelatObjCoor(1,2)+cos(x(9))*cos(x(11))*RelatObjCoor(5,3))+v01;
%        kx1*(x(1)+cos(x(7))*cos(x(9))*RelatObjCoor(6,1)+(cos(x(7))*sin(x(9))*sin(x(11))-sin(x(7))*cos(x(11)))*RelatObjCoor(6,2)+(cos(x(7))*sin(x(9))*cos(x(11))+sin(x(7))*sin(x(11)))*RelatObjCoor(6,3))/(x(5)-sin(x(9))*RelatObjCoor(6,1)+cos(x(9))*sin(x(11))*RelatObjCoor(2,2)+cos(x(9))*cos(x(11))*RelatObjCoor(6,3))+u01;
%        ky1*(x(3)+sin(x(7))*cos(x(9))*RelatObjCoor(6,1)+(sin(x(7))*sin(x(9))*sin(x(11))+cos(x(7))*cos(x(11)))*RelatObjCoor(6,2)+(sin(x(7))*sin(x(9))*cos(x(11))-cos(x(7))*sin(x(11)))*RelatObjCoor(6,3))/(x(5)-sin(x(9))*RelatObjCoor(6,1)+cos(x(9))*sin(x(11))*RelatObjCoor(2,2)+cos(x(9))*cos(x(11))*RelatObjCoor(6,3))+v01;
%        kx1*(x(1)+cos(x(7))*cos(x(9))*RelatObjCoor(7,1)+(cos(x(7))*sin(x(9))*sin(x(11))-sin(x(7))*cos(x(11)))*RelatObjCoor(7,2)+(cos(x(7))*sin(x(9))*cos(x(11))+sin(x(7))*sin(x(11)))*RelatObjCoor(7,3))/(x(5)-sin(x(9))*RelatObjCoor(7,1)+cos(x(9))*sin(x(11))*RelatObjCoor(3,2)+cos(x(9))*cos(x(11))*RelatObjCoor(7,3))+u01;
%        ky1*(x(3)+sin(x(7))*cos(x(9))*RelatObjCoor(7,1)+(sin(x(7))*sin(x(9))*sin(x(11))+cos(x(7))*cos(x(11)))*RelatObjCoor(7,2)+(sin(x(7))*sin(x(9))*cos(x(11))-cos(x(7))*sin(x(11)))*RelatObjCoor(7,3))/(x(5)-sin(x(9))*RelatObjCoor(7,1)+cos(x(9))*sin(x(11))*RelatObjCoor(3,2)+cos(x(9))*cos(x(11))*RelatObjCoor(7,3))+v01;
%        kx1*(x(1)+cos(x(7))*cos(x(9))*RelatObjCoor(8,1)+(cos(x(7))*sin(x(9))*sin(x(11))-sin(x(7))*cos(x(11)))*RelatObjCoor(8,2)+(cos(x(7))*sin(x(9))*cos(x(11))+sin(x(7))*sin(x(11)))*RelatObjCoor(8,3))/(x(5)-sin(x(9))*RelatObjCoor(8,1)+cos(x(9))*sin(x(11))*RelatObjCoor(4,2)+cos(x(9))*cos(x(11))*RelatObjCoor(8,3))+u01;
%        ky1*(x(3)+sin(x(7))*cos(x(9))*RelatObjCoor(8,1)+(sin(x(7))*sin(x(9))*sin(x(11))+cos(x(7))*cos(x(11)))*RelatObjCoor(8,2)+(sin(x(7))*sin(x(9))*cos(x(11))-cos(x(7))*sin(x(11)))*RelatObjCoor(8,3))/(x(5)-sin(x(9))*RelatObjCoor(8,1)+cos(x(9))*sin(x(11))*RelatObjCoor(4,2)+cos(x(9))*cos(x(11))*RelatObjCoor(8,3))+v01]; 
%     
h1=@(x)[kx1*(x(1)+cos(x(11))*cos(x(9))*RelatObjCoor(1,1)+(cos(x(11))*sin(x(9))*sin(x(7))-sin(x(11))*cos(x(7)))*RelatObjCoor(1,2)+(cos(x(11))*sin(x(9))*cos(x(7))+sin(x(11))*sin(x(7)))*RelatObjCoor(1,3))/(x(5)-sin(x(9))*RelatObjCoor(1,1)+cos(x(9))*sin(x(7))*RelatObjCoor(1,2)+cos(x(9))*cos(x(7))*RelatObjCoor(1,3))+u01;
       ky1*(x(3)+sin(x(11))*cos(x(9))*RelatObjCoor(1,1)+(sin(x(11))*sin(x(9))*sin(x(7))+cos(x(11))*cos(x(7)))*RelatObjCoor(1,2)+(sin(x(11))*sin(x(9))*cos(x(7))-cos(x(11))*sin(x(7)))*RelatObjCoor(1,3))/(x(5)-sin(x(9))*RelatObjCoor(1,1)+cos(x(9))*sin(x(7))*RelatObjCoor(1,2)+cos(x(9))*cos(x(7))*RelatObjCoor(1,3))+v01;
       kx1*(x(1)+cos(x(11))*cos(x(9))*RelatObjCoor(2,1)+(cos(x(11))*sin(x(9))*sin(x(7))-sin(x(11))*cos(x(7)))*RelatObjCoor(2,2)+(cos(x(11))*sin(x(9))*cos(x(7))+sin(x(11))*sin(x(7)))*RelatObjCoor(2,3))/(x(5)-sin(x(9))*RelatObjCoor(2,1)+cos(x(9))*sin(x(7))*RelatObjCoor(2,2)+cos(x(9))*cos(x(7))*RelatObjCoor(2,3))+u01;
       ky1*(x(3)+sin(x(11))*cos(x(9))*RelatObjCoor(2,1)+(sin(x(11))*sin(x(9))*sin(x(7))+cos(x(11))*cos(x(7)))*RelatObjCoor(2,2)+(sin(x(11))*sin(x(9))*cos(x(7))-cos(x(11))*sin(x(7)))*RelatObjCoor(2,3))/(x(5)-sin(x(9))*RelatObjCoor(2,1)+cos(x(9))*sin(x(7))*RelatObjCoor(2,2)+cos(x(9))*cos(x(7))*RelatObjCoor(2,3))+v01;
       kx1*(x(1)+cos(x(11))*cos(x(9))*RelatObjCoor(3,1)+(cos(x(11))*sin(x(9))*sin(x(7))-sin(x(11))*cos(x(7)))*RelatObjCoor(3,2)+(cos(x(11))*sin(x(9))*cos(x(7))+sin(x(11))*sin(x(7)))*RelatObjCoor(3,3))/(x(5)-sin(x(9))*RelatObjCoor(3,1)+cos(x(9))*sin(x(7))*RelatObjCoor(3,2)+cos(x(9))*cos(x(7))*RelatObjCoor(3,3))+u01;
       ky1*(x(3)+sin(x(11))*cos(x(9))*RelatObjCoor(3,1)+(sin(x(11))*sin(x(9))*sin(x(7))+cos(x(11))*cos(x(7)))*RelatObjCoor(3,2)+(sin(x(11))*sin(x(9))*cos(x(7))-cos(x(11))*sin(x(7)))*RelatObjCoor(3,3))/(x(5)-sin(x(9))*RelatObjCoor(3,1)+cos(x(9))*sin(x(7))*RelatObjCoor(3,2)+cos(x(9))*cos(x(7))*RelatObjCoor(3,3))+v01;
       kx1*(x(1)+cos(x(11))*cos(x(9))*RelatObjCoor(4,1)+(cos(x(11))*sin(x(9))*sin(x(7))-sin(x(11))*cos(x(7)))*RelatObjCoor(4,2)+(cos(x(11))*sin(x(9))*cos(x(7))+sin(x(11))*sin(x(7)))*RelatObjCoor(4,3))/(x(5)-sin(x(9))*RelatObjCoor(4,1)+cos(x(9))*sin(x(7))*RelatObjCoor(4,2)+cos(x(9))*cos(x(7))*RelatObjCoor(4,3))+u01;
       ky1*(x(3)+sin(x(11))*cos(x(9))*RelatObjCoor(4,1)+(sin(x(11))*sin(x(9))*sin(x(7))+cos(x(11))*cos(x(7)))*RelatObjCoor(4,2)+(sin(x(11))*sin(x(9))*cos(x(7))-cos(x(11))*sin(x(7)))*RelatObjCoor(4,3))/(x(5)-sin(x(9))*RelatObjCoor(4,1)+cos(x(9))*sin(x(7))*RelatObjCoor(4,2)+cos(x(9))*cos(x(7))*RelatObjCoor(4,3))+v01;
       kx1*(x(1)+cos(x(11))*cos(x(9))*RelatObjCoor(5,1)+(cos(x(11))*sin(x(9))*sin(x(7))-sin(x(11))*cos(x(7)))*RelatObjCoor(5,2)+(cos(x(11))*sin(x(9))*cos(x(7))+sin(x(11))*sin(x(7)))*RelatObjCoor(5,3))/(x(5)-sin(x(9))*RelatObjCoor(5,1)+cos(x(9))*sin(x(7))*RelatObjCoor(1,2)+cos(x(9))*cos(x(7))*RelatObjCoor(5,3))+u01;
       ky1*(x(3)+sin(x(11))*cos(x(9))*RelatObjCoor(5,1)+(sin(x(11))*sin(x(9))*sin(x(7))+cos(x(11))*cos(x(7)))*RelatObjCoor(5,2)+(sin(x(11))*sin(x(9))*cos(x(7))-cos(x(11))*sin(x(7)))*RelatObjCoor(5,3))/(x(5)-sin(x(9))*RelatObjCoor(5,1)+cos(x(9))*sin(x(7))*RelatObjCoor(1,2)+cos(x(9))*cos(x(7))*RelatObjCoor(5,3))+v01;
       kx1*(x(1)+cos(x(11))*cos(x(9))*RelatObjCoor(6,1)+(cos(x(11))*sin(x(9))*sin(x(7))-sin(x(11))*cos(x(7)))*RelatObjCoor(6,2)+(cos(x(11))*sin(x(9))*cos(x(7))+sin(x(11))*sin(x(7)))*RelatObjCoor(6,3))/(x(5)-sin(x(9))*RelatObjCoor(6,1)+cos(x(9))*sin(x(7))*RelatObjCoor(2,2)+cos(x(9))*cos(x(7))*RelatObjCoor(6,3))+u01;
       ky1*(x(3)+sin(x(11))*cos(x(9))*RelatObjCoor(6,1)+(sin(x(11))*sin(x(9))*sin(x(7))+cos(x(11))*cos(x(7)))*RelatObjCoor(6,2)+(sin(x(11))*sin(x(9))*cos(x(7))-cos(x(11))*sin(x(7)))*RelatObjCoor(6,3))/(x(5)-sin(x(9))*RelatObjCoor(6,1)+cos(x(9))*sin(x(7))*RelatObjCoor(2,2)+cos(x(9))*cos(x(7))*RelatObjCoor(6,3))+v01;
       kx1*(x(1)+cos(x(11))*cos(x(9))*RelatObjCoor(7,1)+(cos(x(11))*sin(x(9))*sin(x(7))-sin(x(11))*cos(x(7)))*RelatObjCoor(7,2)+(cos(x(11))*sin(x(9))*cos(x(7))+sin(x(11))*sin(x(7)))*RelatObjCoor(7,3))/(x(5)-sin(x(9))*RelatObjCoor(7,1)+cos(x(9))*sin(x(7))*RelatObjCoor(3,2)+cos(x(9))*cos(x(7))*RelatObjCoor(7,3))+u01;
       ky1*(x(3)+sin(x(11))*cos(x(9))*RelatObjCoor(7,1)+(sin(x(11))*sin(x(9))*sin(x(7))+cos(x(11))*cos(x(7)))*RelatObjCoor(7,2)+(sin(x(11))*sin(x(9))*cos(x(7))-cos(x(11))*sin(x(7)))*RelatObjCoor(7,3))/(x(5)-sin(x(9))*RelatObjCoor(7,1)+cos(x(9))*sin(x(7))*RelatObjCoor(3,2)+cos(x(9))*cos(x(7))*RelatObjCoor(7,3))+v01;
       kx1*(x(1)+cos(x(11))*cos(x(9))*RelatObjCoor(8,1)+(cos(x(11))*sin(x(9))*sin(x(7))-sin(x(11))*cos(x(7)))*RelatObjCoor(8,2)+(cos(x(11))*sin(x(9))*cos(x(7))+sin(x(11))*sin(x(7)))*RelatObjCoor(8,3))/(x(5)-sin(x(9))*RelatObjCoor(8,1)+cos(x(9))*sin(x(7))*RelatObjCoor(4,2)+cos(x(9))*cos(x(7))*RelatObjCoor(8,3))+u01;
       ky1*(x(3)+sin(x(11))*cos(x(9))*RelatObjCoor(8,1)+(sin(x(11))*sin(x(9))*sin(x(7))+cos(x(11))*cos(x(7)))*RelatObjCoor(8,2)+(sin(x(11))*sin(x(9))*cos(x(7))-cos(x(11))*sin(x(7)))*RelatObjCoor(8,3))/(x(5)-sin(x(9))*RelatObjCoor(8,1)+cos(x(9))*sin(x(7))*RelatObjCoor(4,2)+cos(x(9))*cos(x(7))*RelatObjCoor(8,3))+v01]; 
    
% h1=@(x)[kx1*(x(1)+cos(x(7))*cos(x(9))*RelatObjCoor(1,1)+(cos(x(7))*sin(x(9))*sin(x(11))-sin(x(7))*cos(x(11)))*RelatObjCoor(1,2)-(cos(x(7))*sin(x(9))*cos(x(11))+sin(x(7))*sin(x(11)))*RelatObjCoor(1,3))/(x(5)+sin(x(9))*RelatObjCoor(1,1)-cos(x(9))*sin(x(11))*RelatObjCoor(1,2)+cos(x(9))*cos(x(11))*RelatObjCoor(1,3))+u01;
%        ky1*(x(3)+sin(x(7))*cos(x(9))*RelatObjCoor(1,1)+(sin(x(7))*sin(x(9))*sin(x(11))+cos(x(7))*cos(x(11)))*RelatObjCoor(1,2)-(sin(x(7))*sin(x(9))*cos(x(11))-cos(x(7))*sin(x(11)))*RelatObjCoor(1,3))/(x(5)+sin(x(9))*RelatObjCoor(1,1)-cos(x(9))*sin(x(11))*RelatObjCoor(1,2)+cos(x(9))*cos(x(11))*RelatObjCoor(1,3))+v01;
%        kx1*(x(1)+cos(x(7))*cos(x(9))*RelatObjCoor(2,1)+(cos(x(7))*sin(x(9))*sin(x(11))-sin(x(7))*cos(x(11)))*RelatObjCoor(2,2)-(cos(x(7))*sin(x(9))*cos(x(11))+sin(x(7))*sin(x(11)))*RelatObjCoor(2,3))/(x(5)+sin(x(9))*RelatObjCoor(2,1)-cos(x(9))*sin(x(11))*RelatObjCoor(2,2)+cos(x(9))*cos(x(11))*RelatObjCoor(2,3))+u01;
%        ky1*(x(3)+sin(x(7))*cos(x(9))*RelatObjCoor(2,1)+(sin(x(7))*sin(x(9))*sin(x(11))+cos(x(7))*cos(x(11)))*RelatObjCoor(2,2)-(sin(x(7))*sin(x(9))*cos(x(11))-cos(x(7))*sin(x(11)))*RelatObjCoor(2,3))/(x(5)+sin(x(9))*RelatObjCoor(2,1)-cos(x(9))*sin(x(11))*RelatObjCoor(2,2)+cos(x(9))*cos(x(11))*RelatObjCoor(2,3))+v01;
%        kx1*(x(1)+cos(x(7))*cos(x(9))*RelatObjCoor(3,1)+(cos(x(7))*sin(x(9))*sin(x(11))-sin(x(7))*cos(x(11)))*RelatObjCoor(3,2)-(cos(x(7))*sin(x(9))*cos(x(11))+sin(x(7))*sin(x(11)))*RelatObjCoor(3,3))/(x(5)+sin(x(9))*RelatObjCoor(3,1)-cos(x(9))*sin(x(11))*RelatObjCoor(3,2)+cos(x(9))*cos(x(11))*RelatObjCoor(3,3))+u01;
%        ky1*(x(3)+sin(x(7))*cos(x(9))*RelatObjCoor(3,1)+(sin(x(7))*sin(x(9))*sin(x(11))+cos(x(7))*cos(x(11)))*RelatObjCoor(3,2)-(sin(x(7))*sin(x(9))*cos(x(11))-cos(x(7))*sin(x(11)))*RelatObjCoor(3,3))/(x(5)+sin(x(9))*RelatObjCoor(3,1)-cos(x(9))*sin(x(11))*RelatObjCoor(3,2)+cos(x(9))*cos(x(11))*RelatObjCoor(3,3))+v01;
%        kx1*(x(1)+cos(x(7))*cos(x(9))*RelatObjCoor(4,1)+(cos(x(7))*sin(x(9))*sin(x(11))-sin(x(7))*cos(x(11)))*RelatObjCoor(4,2)-(cos(x(7))*sin(x(9))*cos(x(11))+sin(x(7))*sin(x(11)))*RelatObjCoor(4,3))/(x(5)+sin(x(9))*RelatObjCoor(4,1)-cos(x(9))*sin(x(11))*RelatObjCoor(4,2)+cos(x(9))*cos(x(11))*RelatObjCoor(4,3))+u01;
%        ky1*(x(3)+sin(x(7))*cos(x(9))*RelatObjCoor(4,1)+(sin(x(7))*sin(x(9))*sin(x(11))+cos(x(7))*cos(x(11)))*RelatObjCoor(4,2)-(sin(x(7))*sin(x(9))*cos(x(11))-cos(x(7))*sin(x(11)))*RelatObjCoor(4,3))/(x(5)+sin(x(9))*RelatObjCoor(4,1)-cos(x(9))*sin(x(11))*RelatObjCoor(4,2)+cos(x(9))*cos(x(11))*RelatObjCoor(4,3))+v01;
%        kx1*(x(1)+cos(x(7))*cos(x(9))*RelatObjCoor(5,1)+(cos(x(7))*sin(x(9))*sin(x(11))-sin(x(7))*cos(x(11)))*RelatObjCoor(5,2)-(cos(x(7))*sin(x(9))*cos(x(11))+sin(x(7))*sin(x(11)))*RelatObjCoor(5,3))/(x(5)+sin(x(9))*RelatObjCoor(5,1)-cos(x(9))*sin(x(11))*RelatObjCoor(1,2)+cos(x(9))*cos(x(11))*RelatObjCoor(5,3))+u01;
%        ky1*(x(3)+sin(x(7))*cos(x(9))*RelatObjCoor(5,1)+(sin(x(7))*sin(x(9))*sin(x(11))+cos(x(7))*cos(x(11)))*RelatObjCoor(5,2)-(sin(x(7))*sin(x(9))*cos(x(11))-cos(x(7))*sin(x(11)))*RelatObjCoor(5,3))/(x(5)+sin(x(9))*RelatObjCoor(5,1)-cos(x(9))*sin(x(11))*RelatObjCoor(1,2)+cos(x(9))*cos(x(11))*RelatObjCoor(5,3))+v01;
%        kx1*(x(1)+cos(x(7))*cos(x(9))*RelatObjCoor(6,1)+(cos(x(7))*sin(x(9))*sin(x(11))-sin(x(7))*cos(x(11)))*RelatObjCoor(6,2)-(cos(x(7))*sin(x(9))*cos(x(11))+sin(x(7))*sin(x(11)))*RelatObjCoor(6,3))/(x(5)+sin(x(9))*RelatObjCoor(6,1)-cos(x(9))*sin(x(11))*RelatObjCoor(2,2)+cos(x(9))*cos(x(11))*RelatObjCoor(6,3))+u01;
%        ky1*(x(3)+sin(x(7))*cos(x(9))*RelatObjCoor(6,1)+(sin(x(7))*sin(x(9))*sin(x(11))+cos(x(7))*cos(x(11)))*RelatObjCoor(6,2)-(sin(x(7))*sin(x(9))*cos(x(11))-cos(x(7))*sin(x(11)))*RelatObjCoor(6,3))/(x(5)+sin(x(9))*RelatObjCoor(6,1)-cos(x(9))*sin(x(11))*RelatObjCoor(2,2)+cos(x(9))*cos(x(11))*RelatObjCoor(6,3))+v01;
%        kx1*(x(1)+cos(x(7))*cos(x(9))*RelatObjCoor(7,1)+(cos(x(7))*sin(x(9))*sin(x(11))-sin(x(7))*cos(x(11)))*RelatObjCoor(7,2)-(cos(x(7))*sin(x(9))*cos(x(11))+sin(x(7))*sin(x(11)))*RelatObjCoor(7,3))/(x(5)+sin(x(9))*RelatObjCoor(7,1)-cos(x(9))*sin(x(11))*RelatObjCoor(3,2)+cos(x(9))*cos(x(11))*RelatObjCoor(7,3))+u01;
%        ky1*(x(3)+sin(x(7))*cos(x(9))*RelatObjCoor(7,1)+(sin(x(7))*sin(x(9))*sin(x(11))+cos(x(7))*cos(x(11)))*RelatObjCoor(7,2)-(sin(x(7))*sin(x(9))*cos(x(11))-cos(x(7))*sin(x(11)))*RelatObjCoor(7,3))/(x(5)+sin(x(9))*RelatObjCoor(7,1)-cos(x(9))*sin(x(11))*RelatObjCoor(3,2)+cos(x(9))*cos(x(11))*RelatObjCoor(7,3))+v01;
%        kx1*(x(1)+cos(x(7))*cos(x(9))*RelatObjCoor(8,1)+(cos(x(7))*sin(x(9))*sin(x(11))-sin(x(7))*cos(x(11)))*RelatObjCoor(8,2)-(cos(x(7))*sin(x(9))*cos(x(11))+sin(x(7))*sin(x(11)))*RelatObjCoor(8,3))/(x(5)+sin(x(9))*RelatObjCoor(8,1)-cos(x(9))*sin(x(11))*RelatObjCoor(4,2)+cos(x(9))*cos(x(11))*RelatObjCoor(8,3))+u01;
%        ky1*(x(3)+sin(x(7))*cos(x(9))*RelatObjCoor(8,1)+(sin(x(7))*sin(x(9))*sin(x(11))+cos(x(7))*cos(x(11)))*RelatObjCoor(8,2)-(sin(x(7))*sin(x(9))*cos(x(11))-cos(x(7))*sin(x(11)))*RelatObjCoor(8,3))/(x(5)+sin(x(9))*RelatObjCoor(8,1)-cos(x(9))*sin(x(11))*RelatObjCoor(4,2)+cos(x(9))*cos(x(11))*RelatObjCoor(8,3))+v01]; 
%         
% h1=@(x)[kx1*(x(1)+cos(x(7))*cos(x(11))*RelatObjCoor(1,1)+cos(x(9))*sin(x(11))*RelatObjCoor(1,2)-sin(x(9))*RelatObjCoor(1,3))/(x(5)+(sin(x(7))*sin(x(11)) + cos(x(7))*cos(x(11))*sin(x(9)))*RelatObjCoor(1,1)+(cos(x(7))*sin(x(9))*sin(x(11)) - cos(x(11))*sin(x(7)))*RelatObjCoor(1,2)+ cos(x(7))*cos(x(9))*RelatObjCoor(1,3))+u01;
%        ky1*(x(3)+(cos(x(11))*sin(x(7))*sin(x(9)) - cos(x(7))*sin(x(11)))*RelatObjCoor(1,1)+ (cos(x(7))*cos(x(11)) + sin(x(7))*sin(x(9))*sin(x(11)))*RelatObjCoor(1,2)+ cos(x(9))*sin(x(7))*RelatObjCoor(1,3))/(x(5)+(sin(x(7))*sin(x(11)) + cos(x(7))*cos(x(11))*sin(x(9)))*RelatObjCoor(1,1)+(cos(x(7))*sin(x(9))*sin(x(11)) - cos(x(11))*sin(x(7)))*RelatObjCoor(1,2)+ cos(x(7))*cos(x(9))*RelatObjCoor(1,3))+v01;
%        kx1*(x(1)+cos(x(7))*cos(x(11))*RelatObjCoor(2,1)+cos(x(9))*sin(x(11))*RelatObjCoor(2,2)-sin(x(9))*RelatObjCoor(2,3))/(x(5)+(sin(x(7))*sin(x(11)) + cos(x(7))*cos(x(11))*sin(x(9)))*RelatObjCoor(2,1)+(cos(x(7))*sin(x(9))*sin(x(11)) - cos(x(11))*sin(x(7)))*RelatObjCoor(2,2)+ cos(x(7))*cos(x(9))*RelatObjCoor(2,3))+u01;
%        ky1*(x(3)+(cos(x(11))*sin(x(7))*sin(x(9)) - cos(x(7))*sin(x(11)))*RelatObjCoor(2,1)+ (cos(x(7))*cos(x(11)) + sin(x(7))*sin(x(9))*sin(x(11)))*RelatObjCoor(2,2)+ cos(x(9))*sin(x(7))*RelatObjCoor(2,3))/(x(5)+(sin(x(7))*sin(x(11)) + cos(x(7))*cos(x(11))*sin(x(9)))*RelatObjCoor(2,1)+(cos(x(7))*sin(x(9))*sin(x(11)) - cos(x(11))*sin(x(7)))*RelatObjCoor(2,2)+ cos(x(7))*cos(x(9))*RelatObjCoor(2,3))+v01;
%        kx1*(x(1)+cos(x(7))*cos(x(11))*RelatObjCoor(3,1)+cos(x(9))*sin(x(11))*RelatObjCoor(3,2)-sin(x(9))*RelatObjCoor(3,3))/(x(5)+(sin(x(7))*sin(x(11)) + cos(x(7))*cos(x(11))*sin(x(9)))*RelatObjCoor(3,1)+(cos(x(7))*sin(x(9))*sin(x(11)) - cos(x(11))*sin(x(7)))*RelatObjCoor(3,2)+ cos(x(7))*cos(x(9))*RelatObjCoor(3,3))+u01;
%        ky1*(x(3)+(cos(x(11))*sin(x(7))*sin(x(9)) - cos(x(7))*sin(x(11)))*RelatObjCoor(3,1)+ (cos(x(7))*cos(x(11)) + sin(x(7))*sin(x(9))*sin(x(11)))*RelatObjCoor(3,2)+ cos(x(9))*sin(x(7))*RelatObjCoor(3,3))/(x(5)+(sin(x(7))*sin(x(11)) + cos(x(7))*cos(x(11))*sin(x(9)))*RelatObjCoor(3,1)+(cos(x(7))*sin(x(9))*sin(x(11)) - cos(x(11))*sin(x(7)))*RelatObjCoor(3,2)+ cos(x(7))*cos(x(9))*RelatObjCoor(3,3))+v01;
%        kx1*(x(1)+cos(x(7))*cos(x(11))*RelatObjCoor(4,1)+cos(x(9))*sin(x(11))*RelatObjCoor(4,2)-sin(x(9))*RelatObjCoor(4,3))/(x(5)+(sin(x(7))*sin(x(11)) + cos(x(7))*cos(x(11))*sin(x(9)))*RelatObjCoor(4,1)+(cos(x(7))*sin(x(9))*sin(x(11)) - cos(x(11))*sin(x(7)))*RelatObjCoor(4,2)+ cos(x(7))*cos(x(9))*RelatObjCoor(4,3))+u01;
%        ky1*(x(3)+(cos(x(11))*sin(x(7))*sin(x(9)) - cos(x(7))*sin(x(11)))*RelatObjCoor(4,1)+ (cos(x(7))*cos(x(11)) + sin(x(7))*sin(x(9))*sin(x(11)))*RelatObjCoor(4,2)+ cos(x(9))*sin(x(7))*RelatObjCoor(4,3))/(x(5)+(sin(x(7))*sin(x(11)) + cos(x(7))*cos(x(11))*sin(x(9)))*RelatObjCoor(4,1)+(cos(x(7))*sin(x(9))*sin(x(11)) - cos(x(11))*sin(x(7)))*RelatObjCoor(4,2)+ cos(x(7))*cos(x(9))*RelatObjCoor(4,3))+v01;
%        kx1*(x(1)+cos(x(7))*cos(x(11))*RelatObjCoor(5,1)+cos(x(9))*sin(x(11))*RelatObjCoor(5,2)-sin(x(9))*RelatObjCoor(5,3))/(x(5)+(sin(x(7))*sin(x(11)) + cos(x(7))*cos(x(11))*sin(x(9)))*RelatObjCoor(5,1)+(cos(x(7))*sin(x(9))*sin(x(11)) - cos(x(11))*sin(x(7)))*RelatObjCoor(5,2)+ cos(x(7))*cos(x(9))*RelatObjCoor(5,3))+u01;
%        ky1*(x(3)+(cos(x(11))*sin(x(7))*sin(x(9)) - cos(x(7))*sin(x(11)))*RelatObjCoor(5,1)+ (cos(x(7))*cos(x(11)) + sin(x(7))*sin(x(9))*sin(x(11)))*RelatObjCoor(5,2)+ cos(x(9))*sin(x(7))*RelatObjCoor(5,3))/(x(5)+(sin(x(7))*sin(x(11)) + cos(x(7))*cos(x(11))*sin(x(9)))*RelatObjCoor(5,1)+(cos(x(7))*sin(x(9))*sin(x(11)) - cos(x(11))*sin(x(7)))*RelatObjCoor(5,2)+ cos(x(7))*cos(x(9))*RelatObjCoor(5,3))+v01;
%        kx1*(x(1)+cos(x(7))*cos(x(11))*RelatObjCoor(6,1)+cos(x(9))*sin(x(11))*RelatObjCoor(6,2)-sin(x(9))*RelatObjCoor(6,3))/(x(5)+(sin(x(7))*sin(x(11)) + cos(x(7))*cos(x(11))*sin(x(9)))*RelatObjCoor(6,1)+(cos(x(7))*sin(x(9))*sin(x(11)) - cos(x(11))*sin(x(7)))*RelatObjCoor(6,2)+ cos(x(7))*cos(x(9))*RelatObjCoor(6,3))+u01;
%        ky1*(x(3)+(cos(x(11))*sin(x(7))*sin(x(9)) - cos(x(7))*sin(x(11)))*RelatObjCoor(6,1)+ (cos(x(7))*cos(x(11)) + sin(x(7))*sin(x(9))*sin(x(11)))*RelatObjCoor(6,2)+ cos(x(9))*sin(x(7))*RelatObjCoor(6,3))/(x(5)+(sin(x(7))*sin(x(11)) + cos(x(7))*cos(x(11))*sin(x(9)))*RelatObjCoor(6,1)+(cos(x(7))*sin(x(9))*sin(x(11)) - cos(x(11))*sin(x(7)))*RelatObjCoor(6,2)+ cos(x(7))*cos(x(9))*RelatObjCoor(6,3))+v01;
%        kx1*(x(1)+cos(x(7))*cos(x(11))*RelatObjCoor(7,1)+cos(x(9))*sin(x(11))*RelatObjCoor(7,2)-sin(x(9))*RelatObjCoor(7,3))/(x(5)+(sin(x(7))*sin(x(11)) + cos(x(7))*cos(x(11))*sin(x(9)))*RelatObjCoor(7,1)+(cos(x(7))*sin(x(9))*sin(x(11)) - cos(x(11))*sin(x(7)))*RelatObjCoor(7,2)+ cos(x(7))*cos(x(9))*RelatObjCoor(7,3))+u01;
%        ky1*(x(3)+(cos(x(11))*sin(x(7))*sin(x(9)) - cos(x(7))*sin(x(11)))*RelatObjCoor(7,1)+ (cos(x(7))*cos(x(11)) + sin(x(7))*sin(x(9))*sin(x(11)))*RelatObjCoor(7,2)+ cos(x(9))*sin(x(7))*RelatObjCoor(7,3))/(x(5)+(sin(x(7))*sin(x(11)) + cos(x(7))*cos(x(11))*sin(x(9)))*RelatObjCoor(7,1)+(cos(x(7))*sin(x(9))*sin(x(11)) - cos(x(11))*sin(x(7)))*RelatObjCoor(7,2)+ cos(x(7))*cos(x(9))*RelatObjCoor(7,3))+v01;
%        kx1*(x(1)+cos(x(7))*cos(x(11))*RelatObjCoor(8,1)+cos(x(9))*sin(x(11))*RelatObjCoor(8,2)-sin(x(9))*RelatObjCoor(8,3))/(x(5)+(sin(x(7))*sin(x(11)) + cos(x(7))*cos(x(11))*sin(x(9)))*RelatObjCoor(8,1)+(cos(x(7))*sin(x(9))*sin(x(11)) - cos(x(11))*sin(x(7)))*RelatObjCoor(8,2)+ cos(x(7))*cos(x(9))*RelatObjCoor(8,3))+u01;
%        ky1*(x(3)+(cos(x(11))*sin(x(7))*sin(x(9)) - cos(x(7))*sin(x(11)))*RelatObjCoor(8,1)+ (cos(x(7))*cos(x(11)) + sin(x(7))*sin(x(9))*sin(x(11)))*RelatObjCoor(8,2)+ cos(x(9))*sin(x(7))*RelatObjCoor(8,3))/(x(5)+(sin(x(7))*sin(x(11)) + cos(x(7))*cos(x(11))*sin(x(9)))*RelatObjCoor(8,1)+(cos(x(7))*sin(x(9))*sin(x(11)) - cos(x(11))*sin(x(7)))*RelatObjCoor(8,2)+ cos(x(7))*cos(x(9))*RelatObjCoor(8,3))+v01];
h2=@(x)[kx2*(T(1,:)*[x(1);x(3);x(5);1]+cos(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(1,1)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))-sin(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(1,2)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))+sin(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(1,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(1,1)+cos(x(9)+euler2(2))*sin(x(7)+euler2(1))*RelatObjCoor(1,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(1,3))+u02;
       ky2*(T(2,:)*[x(1);x(3);x(5);1]+sin(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(1,1)+(-sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))+cos(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(1,2)+(sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))-cos(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(1,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(1,1)+cos(x(9)+euler2(2))*sin(x(7)+euler2(1))*RelatObjCoor(1,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(1,3))+v02;
       kx2*(T(1,:)*[x(1);x(3);x(5);1]+cos(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(2,1)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))-sin(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(2,2)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))+sin(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(2,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(2,1)+cos(x(9)+euler2(2))*sin(x(7)+euler2(1))*RelatObjCoor(2,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(2,3))+u02;
       ky2*(T(2,:)*[x(1);x(3);x(5);1]+sin(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(2,1)+(-sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))+cos(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(2,2)+(sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))-cos(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(2,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(2,1)+cos(x(9)+euler2(2))*sin(x(7)+euler2(1))*RelatObjCoor(2,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(2,3))+v02;
       kx2*(T(1,:)*[x(1);x(3);x(5);1]+cos(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(3,1)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))-sin(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(3,2)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))+sin(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(3,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(3,1)+cos(x(9)+euler2(2))*sin(x(7)+euler2(1))*RelatObjCoor(3,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(3,3))+u02;
       ky2*(T(2,:)*[x(1);x(3);x(5);1]+sin(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(3,1)+(-sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))+cos(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(3,2)+(sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))-cos(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(3,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(3,1)+cos(x(9)+euler2(2))*sin(x(7)+euler2(1))*RelatObjCoor(3,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(3,3))+v02;
       kx2*(T(1,:)*[x(1);x(3);x(5);1]+cos(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(4,1)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))-sin(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(4,2)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))+sin(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(4,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(4,1)+cos(x(9)+euler2(2))*(sin(x(7)+euler2(1)))*RelatObjCoor(4,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(4,3))+u02;
       ky2*(T(2,:)*[x(1);x(3);x(5);1]+sin(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(4,1)+(-sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))+cos(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(4,2)+(sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))-cos(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(4,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(4,1)+cos(x(9)+euler2(2))*sin(x(7)+euler2(1))*RelatObjCoor(4,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(4,3))+v02; 
       kx2*(T(1,:)*[x(1);x(3);x(5);1]+cos(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(5,1)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))-sin(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(5,2)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))+sin(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(5,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(5,1)+cos(x(9)+euler2(2))*sin(x(7)+euler2(1))*RelatObjCoor(5,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(5,3))+u02;
       ky2*(T(2,:)*[x(1);x(3);x(5);1]+sin(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(5,1)+(-sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))+cos(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(5,2)+(sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))-cos(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(5,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(5,1)+cos(x(9)+euler2(2))*sin(x(7)+euler2(1))*RelatObjCoor(5,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(5,3))+v02;
       kx2*(T(1,:)*[x(1);x(3);x(5);1]+cos(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(6,1)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))-sin(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(6,2)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))+sin(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(6,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(6,1)+cos(x(9)+euler2(2))*sin(x(7)+euler2(1))*RelatObjCoor(6,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(6,3))+u02;
       ky2*(T(2,:)*[x(1);x(3);x(5);1]+sin(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(6,1)+(-sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))+cos(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(6,2)+(sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))-cos(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(6,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(6,1)+cos(x(9)+euler2(2))*sin(x(7)+euler2(1))*RelatObjCoor(6,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(6,3))+v02;
       kx2*(T(1,:)*[x(1);x(3);x(5);1]+cos(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(7,1)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))-sin(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(7,2)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))+sin(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(7,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(7,1)+cos(x(9)+euler2(2))*sin(x(7)+euler2(1))*RelatObjCoor(7,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(7,3))+u02;
       ky2*(T(2,:)*[x(1);x(3);x(5);1]+sin(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(7,1)+(-sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))+cos(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(7,2)+(sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))-cos(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(7,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(7,1)+cos(x(9)+euler2(2))*sin(x(7)+euler2(1))*RelatObjCoor(7,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(7,3))+v02;
       kx2*(T(1,:)*[x(1);x(3);x(5);1]+cos(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(8,1)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))-sin(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(8,2)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))+sin(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(8,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(8,1)+cos(x(9)+euler2(2))*(sin(x(7)+euler2(1)))*RelatObjCoor(8,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(8,3))+u02;
       ky2*(T(2,:)*[x(1);x(3);x(5);1]+sin(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(8,1)+(-sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))+cos(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(8,2)+(sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))-cos(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(8,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(8,1)+cos(x(9)+euler2(2))*sin(x(7)+euler2(1))*RelatObjCoor(8,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(8,3))+v02]; 

h=@(x)[kx1*(x(1)+cos(x(11))*cos(x(9))*RelatObjCoor(1,1)+(cos(x(11))*sin(x(9))*sin(x(7))-sin(x(11))*cos(x(7)))*RelatObjCoor(1,2)+(cos(x(11))*sin(x(9))*cos(x(7))+sin(x(11))*sin(x(7)))*RelatObjCoor(1,3))/(x(5)-sin(x(9))*RelatObjCoor(1,1)+cos(x(9))*sin(x(7))*RelatObjCoor(1,2)+cos(x(9))*cos(x(7))*RelatObjCoor(1,3))+u01;
       ky1*(x(3)+sin(x(11))*cos(x(9))*RelatObjCoor(1,1)+(sin(x(11))*sin(x(9))*sin(x(7))+cos(x(11))*cos(x(7)))*RelatObjCoor(1,2)+(sin(x(11))*sin(x(9))*cos(x(7))-cos(x(11))*sin(x(7)))*RelatObjCoor(1,3))/(x(5)-sin(x(9))*RelatObjCoor(1,1)+cos(x(9))*sin(x(7))*RelatObjCoor(1,2)+cos(x(9))*cos(x(7))*RelatObjCoor(1,3))+v01;
       kx1*(x(1)+cos(x(11))*cos(x(9))*RelatObjCoor(2,1)+(cos(x(11))*sin(x(9))*sin(x(7))-sin(x(11))*cos(x(7)))*RelatObjCoor(2,2)+(cos(x(11))*sin(x(9))*cos(x(7))+sin(x(11))*sin(x(7)))*RelatObjCoor(2,3))/(x(5)-sin(x(9))*RelatObjCoor(2,1)+cos(x(9))*sin(x(7))*RelatObjCoor(2,2)+cos(x(9))*cos(x(7))*RelatObjCoor(2,3))+u01;
       ky1*(x(3)+sin(x(11))*cos(x(9))*RelatObjCoor(2,1)+(sin(x(11))*sin(x(9))*sin(x(7))+cos(x(11))*cos(x(7)))*RelatObjCoor(2,2)+(sin(x(11))*sin(x(9))*cos(x(7))-cos(x(11))*sin(x(7)))*RelatObjCoor(2,3))/(x(5)-sin(x(9))*RelatObjCoor(2,1)+cos(x(9))*sin(x(7))*RelatObjCoor(2,2)+cos(x(9))*cos(x(7))*RelatObjCoor(2,3))+v01;
       kx1*(x(1)+cos(x(11))*cos(x(9))*RelatObjCoor(3,1)+(cos(x(11))*sin(x(9))*sin(x(7))-sin(x(11))*cos(x(7)))*RelatObjCoor(3,2)+(cos(x(11))*sin(x(9))*cos(x(7))+sin(x(11))*sin(x(7)))*RelatObjCoor(3,3))/(x(5)-sin(x(9))*RelatObjCoor(3,1)+cos(x(9))*sin(x(7))*RelatObjCoor(3,2)+cos(x(9))*cos(x(7))*RelatObjCoor(3,3))+u01;
       ky1*(x(3)+sin(x(11))*cos(x(9))*RelatObjCoor(3,1)+(sin(x(11))*sin(x(9))*sin(x(7))+cos(x(11))*cos(x(7)))*RelatObjCoor(3,2)+(sin(x(11))*sin(x(9))*cos(x(7))-cos(x(11))*sin(x(7)))*RelatObjCoor(3,3))/(x(5)-sin(x(9))*RelatObjCoor(3,1)+cos(x(9))*sin(x(7))*RelatObjCoor(3,2)+cos(x(9))*cos(x(7))*RelatObjCoor(3,3))+v01;
       kx1*(x(1)+cos(x(11))*cos(x(9))*RelatObjCoor(4,1)+(cos(x(11))*sin(x(9))*sin(x(7))-sin(x(11))*cos(x(7)))*RelatObjCoor(4,2)+(cos(x(11))*sin(x(9))*cos(x(7))+sin(x(11))*sin(x(7)))*RelatObjCoor(4,3))/(x(5)-sin(x(9))*RelatObjCoor(4,1)+cos(x(9))*sin(x(7))*RelatObjCoor(4,2)+cos(x(9))*cos(x(7))*RelatObjCoor(4,3))+u01;
       ky1*(x(3)+sin(x(11))*cos(x(9))*RelatObjCoor(4,1)+(sin(x(11))*sin(x(9))*sin(x(7))+cos(x(11))*cos(x(7)))*RelatObjCoor(4,2)+(sin(x(11))*sin(x(9))*cos(x(7))-cos(x(11))*sin(x(7)))*RelatObjCoor(4,3))/(x(5)-sin(x(9))*RelatObjCoor(4,1)+cos(x(9))*sin(x(7))*RelatObjCoor(4,2)+cos(x(9))*cos(x(7))*RelatObjCoor(4,3))+v01;
       kx1*(x(1)+cos(x(11))*cos(x(9))*RelatObjCoor(5,1)+(cos(x(11))*sin(x(9))*sin(x(7))-sin(x(11))*cos(x(7)))*RelatObjCoor(5,2)+(cos(x(11))*sin(x(9))*cos(x(7))+sin(x(11))*sin(x(7)))*RelatObjCoor(5,3))/(x(5)-sin(x(9))*RelatObjCoor(5,1)+cos(x(9))*sin(x(7))*RelatObjCoor(1,2)+cos(x(9))*cos(x(7))*RelatObjCoor(5,3))+u01;
       ky1*(x(3)+sin(x(11))*cos(x(9))*RelatObjCoor(5,1)+(sin(x(11))*sin(x(9))*sin(x(7))+cos(x(11))*cos(x(7)))*RelatObjCoor(5,2)+(sin(x(11))*sin(x(9))*cos(x(7))-cos(x(11))*sin(x(7)))*RelatObjCoor(5,3))/(x(5)-sin(x(9))*RelatObjCoor(5,1)+cos(x(9))*sin(x(7))*RelatObjCoor(1,2)+cos(x(9))*cos(x(7))*RelatObjCoor(5,3))+v01;
       kx1*(x(1)+cos(x(11))*cos(x(9))*RelatObjCoor(6,1)+(cos(x(11))*sin(x(9))*sin(x(7))-sin(x(11))*cos(x(7)))*RelatObjCoor(6,2)+(cos(x(11))*sin(x(9))*cos(x(7))+sin(x(11))*sin(x(7)))*RelatObjCoor(6,3))/(x(5)-sin(x(9))*RelatObjCoor(6,1)+cos(x(9))*sin(x(7))*RelatObjCoor(2,2)+cos(x(9))*cos(x(7))*RelatObjCoor(6,3))+u01;
       ky1*(x(3)+sin(x(11))*cos(x(9))*RelatObjCoor(6,1)+(sin(x(11))*sin(x(9))*sin(x(7))+cos(x(11))*cos(x(7)))*RelatObjCoor(6,2)+(sin(x(11))*sin(x(9))*cos(x(7))-cos(x(11))*sin(x(7)))*RelatObjCoor(6,3))/(x(5)-sin(x(9))*RelatObjCoor(6,1)+cos(x(9))*sin(x(7))*RelatObjCoor(2,2)+cos(x(9))*cos(x(7))*RelatObjCoor(6,3))+v01;
       kx1*(x(1)+cos(x(11))*cos(x(9))*RelatObjCoor(7,1)+(cos(x(11))*sin(x(9))*sin(x(7))-sin(x(11))*cos(x(7)))*RelatObjCoor(7,2)+(cos(x(11))*sin(x(9))*cos(x(7))+sin(x(11))*sin(x(7)))*RelatObjCoor(7,3))/(x(5)-sin(x(9))*RelatObjCoor(7,1)+cos(x(9))*sin(x(7))*RelatObjCoor(3,2)+cos(x(9))*cos(x(7))*RelatObjCoor(7,3))+u01;
       ky1*(x(3)+sin(x(11))*cos(x(9))*RelatObjCoor(7,1)+(sin(x(11))*sin(x(9))*sin(x(7))+cos(x(11))*cos(x(7)))*RelatObjCoor(7,2)+(sin(x(11))*sin(x(9))*cos(x(7))-cos(x(11))*sin(x(7)))*RelatObjCoor(7,3))/(x(5)-sin(x(9))*RelatObjCoor(7,1)+cos(x(9))*sin(x(7))*RelatObjCoor(3,2)+cos(x(9))*cos(x(7))*RelatObjCoor(7,3))+v01;
       kx1*(x(1)+cos(x(11))*cos(x(9))*RelatObjCoor(8,1)+(cos(x(11))*sin(x(9))*sin(x(7))-sin(x(11))*cos(x(7)))*RelatObjCoor(8,2)+(cos(x(11))*sin(x(9))*cos(x(7))+sin(x(11))*sin(x(7)))*RelatObjCoor(8,3))/(x(5)-sin(x(9))*RelatObjCoor(8,1)+cos(x(9))*sin(x(7))*RelatObjCoor(4,2)+cos(x(9))*cos(x(7))*RelatObjCoor(8,3))+u01;
       ky1*(x(3)+sin(x(11))*cos(x(9))*RelatObjCoor(8,1)+(sin(x(11))*sin(x(9))*sin(x(7))+cos(x(11))*cos(x(7)))*RelatObjCoor(8,2)+(sin(x(11))*sin(x(9))*cos(x(7))-cos(x(11))*sin(x(7)))*RelatObjCoor(8,3))/(x(5)-sin(x(9))*RelatObjCoor(8,1)+cos(x(9))*sin(x(7))*RelatObjCoor(4,2)+cos(x(9))*cos(x(7))*RelatObjCoor(8,3))+v01; 
       kx2*(T(1,:)*[x(1);x(3);x(5);1]+cos(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(1,1)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))-sin(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(1,2)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))+sin(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(1,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(1,1)+cos(x(9)+euler2(2))*sin(x(7)+euler2(1))*RelatObjCoor(1,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(1,3))+u02;
       ky2*(T(2,:)*[x(1);x(3);x(5);1]+sin(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(1,1)+(-sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))+cos(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(1,2)+(sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))-cos(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(1,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(1,1)+cos(x(9)+euler2(2))*sin(x(7)+euler2(1))*RelatObjCoor(1,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(1,3))+v02;
       kx2*(T(1,:)*[x(1);x(3);x(5);1]+cos(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(2,1)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))-sin(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(2,2)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))+sin(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(2,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(2,1)+cos(x(9)+euler2(2))*sin(x(7)+euler2(1))*RelatObjCoor(2,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(2,3))+u02;
       ky2*(T(2,:)*[x(1);x(3);x(5);1]+sin(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(2,1)+(-sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))+cos(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(2,2)+(sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))-cos(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(2,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(2,1)+cos(x(9)+euler2(2))*sin(x(7)+euler2(1))*RelatObjCoor(2,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(2,3))+v02;
       kx2*(T(1,:)*[x(1);x(3);x(5);1]+cos(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(3,1)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))-sin(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(3,2)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))+sin(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(3,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(3,1)+cos(x(9)+euler2(2))*sin(x(7)+euler2(1))*RelatObjCoor(3,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(3,3))+u02;
       ky2*(T(2,:)*[x(1);x(3);x(5);1]+sin(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(3,1)+(-sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))+cos(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(3,2)+(sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))-cos(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(3,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(3,1)+cos(x(9)+euler2(2))*sin(x(7)+euler2(1))*RelatObjCoor(3,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(3,3))+v02;
       kx2*(T(1,:)*[x(1);x(3);x(5);1]+cos(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(4,1)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))-sin(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(4,2)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))+sin(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(4,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(4,1)+cos(x(9)+euler2(2))*(sin(x(7)+euler2(1)))*RelatObjCoor(4,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(4,3))+u02;
       ky2*(T(2,:)*[x(1);x(3);x(5);1]+sin(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(4,1)+(-sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))+cos(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(4,2)+(sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))-cos(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(4,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(4,1)+cos(x(9)+euler2(2))*sin(x(7)+euler2(1))*RelatObjCoor(4,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(4,3))+v02; 
       kx2*(T(1,:)*[x(1);x(3);x(5);1]+cos(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(5,1)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))-sin(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(5,2)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))+sin(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(5,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(5,1)+cos(x(9)+euler2(2))*sin(x(7)+euler2(1))*RelatObjCoor(5,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(5,3))+u02;
       ky2*(T(2,:)*[x(1);x(3);x(5);1]+sin(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(5,1)+(-sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))+cos(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(5,2)+(sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))-cos(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(5,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(5,1)+cos(x(9)+euler2(2))*sin(x(7)+euler2(1))*RelatObjCoor(5,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(5,3))+v02;
       kx2*(T(1,:)*[x(1);x(3);x(5);1]+cos(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(6,1)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))-sin(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(6,2)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))+sin(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(6,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(6,1)+cos(x(9)+euler2(2))*sin(x(7)+euler2(1))*RelatObjCoor(6,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(6,3))+u02;
       ky2*(T(2,:)*[x(1);x(3);x(5);1]+sin(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(6,1)+(-sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))+cos(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(6,2)+(sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))-cos(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(6,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(6,1)+cos(x(9)+euler2(2))*sin(x(7)+euler2(1))*RelatObjCoor(6,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(6,3))+v02;
       kx2*(T(1,:)*[x(1);x(3);x(5);1]+cos(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(7,1)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))-sin(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(7,2)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))+sin(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(7,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(7,1)+cos(x(9)+euler2(2))*sin(x(7)+euler2(1))*RelatObjCoor(7,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(7,3))+u02;
       ky2*(T(2,:)*[x(1);x(3);x(5);1]+sin(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(7,1)+(-sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))+cos(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(7,2)+(sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))-cos(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(7,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(7,1)+cos(x(9)+euler2(2))*sin(x(7)+euler2(1))*RelatObjCoor(7,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(7,3))+v02;
       kx2*(T(1,:)*[x(1);x(3);x(5);1]+cos(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(8,1)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))-sin(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(8,2)+(cos(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))+sin(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(8,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(8,1)+cos(x(9)+euler2(2))*(sin(x(7)+euler2(1)))*RelatObjCoor(8,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(8,3))+u02;
       ky2*(T(2,:)*[x(1);x(3);x(5);1]+sin(x(11)+euler2(3))*cos(x(9)+euler2(2))*RelatObjCoor(8,1)+(-sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*sin(x(7)+euler2(1))+cos(x(11)+euler2(3))*cos(x(7)))*RelatObjCoor(8,2)+(sin(x(11)+euler2(3))*sin(x(9)+euler2(2))*cos(x(7)+euler2(1))-cos(x(11)+euler2(3))*sin(x(7)+euler2(1)))*RelatObjCoor(8,3))/(T(3,:)*[x(1);x(3);x(5);1]-sin(x(9)+euler2(2))*RelatObjCoor(8,1)+cos(x(9)+euler2(2))*sin(x(7)+euler2(1))*RelatObjCoor(8,2)+cos(x(9)+euler2(2))*cos(x(7)+euler2(1))*RelatObjCoor(8,3))+v02]; 

Q = 0.1*diag([0,0.5,0,0.5,0,0.5,0,0.5,0,0.5,0,0.5],0);
Q1 = 0.1*diag([0,0.5,0,0.5,0,0.5,0,0.5,0,0.5,0,0.5],0);
% R = 0.06*eye(8);
R = 50*diag([0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.05]);
if flag == 1
    [x,~,P,~,~,~,~] = ukf(f,x,P,h1,z,Q,R);
elseif flag == 2
    [x,~,P,~,~,~,~] = ukf(f,x,P,h2,z,Q,R);
elseif flag == 3
    if (m>1)
        if isempty(xm1)
            xm1 = x;
        end
        if isempty(xm2)
            xm2 = x;
        end
        z1 = z(:,1);z2 = z(:,2);
        [xm1,~,P1,~,DevX1,DevZ1,K1] = ukf(f,xm1,P,h1,z1,Q,R);
        [xm2,~,P2,~,DevX2,DevZ2,K2] = ukf(f,xm2,P,h2,z2,Q,R);
        [ x ] = strong_nolinear_Matrix_weighted( xm1,xm2,DevX1,DevX2,DevZ1,DevZ2,K1,K2,P1,P2,Q1);
    end
elseif flag == 4
    if (m>1)
        if isempty(xd1)
            xd1 = x;
        end
        if isempty(xd2)
            xd2 = x;
        end
        z1 = z(:,1);z2 = z(:,2);
        [xd1,xp1,P1,Pp1,~,~,~] = ukf(f,xd1,P,h1,z1,Q,R);
        [xd2,xp2,P2,Pp2,~,~,~] = ukf(f,xd2,P,h2,z2,Q,R);
        [ x,P ] = distribute_strong_noliner_fusion(f, Q1,P1,P2,Pp1,Pp2,P,xd1,xd2,xp1,xp2,x); 
    end
elseif flag == 5
    if (m>1)
        z1 = z(:,1);z2 = z(:,2);
        z3 = [z1;z2];
        Rj = blkdiag(R,R);
        [x,~,P,~,~,~,~] = ukf(f,x,P,h,z3,Q1,Rj);
    end
end
end

